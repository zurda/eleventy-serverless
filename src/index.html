<style>
  h1 {
    text-align: left;
  }

  .pokemons {
    display: flex;
    flex-direction: row;
    align-items: flex-end;
    justify-content: space-between;
  }

  @media screen and (max-width: 700px) {
    .pokemons {
      flex-direction: column;
      align-items: center;
    }
  }

  .pokemon {
    display: flex;
    flex-direction: column;
    max-width: 90vw;
    height: 400px;
  }

  .pokemon img {
    display: block;
    height: 200px;
  }

  .pokemon h2 {
    margin: 0.5rem 0 0;
  }

  .pokemon .team-members h4 {
    margin: 0;
  }

  .pokemon .team-members h4 a {
    font-weight: normal;
    padding-left: 0.4rem;
    color: var(--grey);
  }


  h3 {
    margin: 1rem 0 0.1rem 0;
  }

  .abilities {
    margin: 0;
    padding-left: 0;
  }

  .abilities * {
    list-style: none;
    text-transform: uppercase;
    font-size: 12px;
  }

  button {
    display: none;
    align-self: center;
    background: var(--green);
    border: 0;
    border-radius: 0.25rem;
    color: var(--white);
    font-family: var(--font-family);
    margin: 1rem 0 0;
    padding: 0.5rem 1rem;
    text-transform: uppercase;
  }

  .loader {
    display: block;
    margin: 0 auto;
    border: 16px solid var(--light-grey);
    border-top: 16px solid var(--blue);
    border-radius: 50%;
    width: 120px;
    height: 120px;
    animation: spin 2s linear infinite;
  }

  @keyframes spin {
    0% {
      transform: rotate(0deg);
    }

    100% {
      transform: rotate(360deg);
    }
  }
</style>
<h1>Feds</h1>
<div class="loader"></div>
<div class="pokemons"></div>

<button class="toggle-button" onclick="toggleImages()">Toggle images</button>

<template id="pokemon-template">
  <div class="pokemon">
    <img class="img" />
    <img class="gif" />

    <h2></h2>

    <div class="team-members"></div>

    <h3>Abilities</h3>
    <ul class="abilities"></ul>
  </div>
</template>

<script type="text/javascript" src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script>

<script>
  function toggleImages() {
    const images = document.querySelectorAll('img.img');
    const gifs = document.querySelectorAll('img.gif');

    if (gifs[0].style.display === 'none') {
      images.forEach(img => img.style.display = 'none');
      gifs.forEach(gif => gif.style.display = 'block');
    } else {
      gifs.forEach(img => img.style.display = 'none');
      images.forEach(gif => gif.style.display = 'block');
    }
  }

  function capitalize(str) {
    return str.charAt(0).toUpperCase() + str.slice(1);
  }

  function addAbilities(element, abilities) {
    abilities.forEach((ability) => {
      const item = document.createElement('li');
      const label = document.createElement('span');

      label.innerText = capitalize(ability.ability.name);
      item.appendChild(label);

      const value = document.createElement('span');

      const abilityElement = element.querySelector('.abilities');
      abilityElement.appendChild(item);
    });
  }

  async function initialize() {
    const pokemons = await fetch('/.netlify/functions/pokemons')
      .then((response) => response.json());

    const container = document.querySelector('.pokemons');
    const template = document.querySelector('#pokemon-template');

    pokemons.forEach((pokemon) => {
      const element = template.content.cloneNode(true);

      const img = element.querySelector('img.img');
      img.src = pokemon.image;

      const gif = element.querySelector('img.gif');
      gif.src = pokemon.gif;

      img.alt = pokemon.pokemon_name;
      gif.alt = pokemon.pokemon_name;

      gif.style.display = 'none';

      element.querySelector('h2').innerText = capitalize(pokemon.pokemon_name)

      const teamMembers = pokemon.team_members;

      const membersEl = element.querySelector('.team-members');
      teamMembers.forEach(({member_name, github_user}) => {

        const memberName = document.createElement('h4');
        memberName.innerText = member_name;

        if (github_user) {
          const memberGithub = document.createElement('a');
          memberGithub.innerText = `@${github_user}`;
          memberGithub.href = `https://github.com/${github_user}`;
          memberName.appendChild(memberGithub)
        }
        
        membersEl.appendChild(memberName);
      })

      addAbilities(element, pokemon.abilities);

      container.appendChild(element);
    });

    const toggleButton = document.querySelector('button.toggle-button');
    toggleButton.style.display = 'block';

    const loader = document.querySelector('div.loader');
    loader.style.display = 'none';
  }

  initialize();
</script>